<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Messages Listening....!</title>
</head>
<body>
<h3>Messages Listening....!</h3>
<p id="result"></p>
<script type="text/javascript">
//var url = "rest/broadcast";
//var url = "rest/jsonbroadcast";
//var url ="http://localhost:1111/SSEKafkaConsumer/rest/jsonbroadcast"
var url ="http://httpsse.invent.symphoni.io/ssebroadcast/"
//var url ="https://sse.invent.symphoni.io/ssebroadcast/";
//var url ="http://localhost:8001/ssebroadcast/";
//var url = "rest/events";
var access_token ="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJuYWdlbmRyYS5vYmJ1QHN5bmNvbXMuY29tIiwic2NvcGUiOlsiZnVsbCJdLCJ0ZW5hbnRJZCI6IjI5MkZFQzc2LTVGMUMtNDg2Ri04NUE1LTA5RDg4MDk2RjA5OCIsImV4cCI6MTQ4MDMxOTM0NiwiYXV0aG9yaXRpZXMiOlsiTWFuYWdlciJdLCJqdGkiOiIxY2Y1NjEyNC0yZTM0LTQzNmYtODczYi0yNDU1NjcxNThkNTEiLCJjbGllbnRfaWQiOiJjb2RlY2xpZW50In0.NTuGE_HkbpgKYoc7d3SzeUM8D77fVHc9vmEyRm-LJHlzmjJPi4CLiPMwbSo6ngsifsHajCTt391x77cYAv6x81QFjS9uePjP3_FyBlUfpfKktmuQVadqcJITE5uAqbzYKoSAQNL26IiUdM9dvMdeg8HMeOtw7jTUaANC9UsD4cOXE9_1gqKWUmGNqKWcF-ZAasqlCyX1jIbxnesRCv8SCDpgd91CYeqIaepoT1xg_KFGbtz7TYcsmU1x-uU6vc1F-B4QkFEfCYbas7Jj4NDJjD6bgEKqEyWeTxzbDKzU_ewPvk2trn2cdcUV0Alxw0tpiwhKVh9O9QxHyf2-ZuG8MA";
//var source=new EventSource(url.concat("?access_token="+access_token));
var source=new EventSource(url);
//var request = new XMLHttpRequest();
var request ;
if (window.XMLHttpRequest) {
	request = new XMLHttpRequest();
	
  } else {
    // code for older browsers
    request = new ActiveXObject("Microsoft.XMLHTTP");
  }
request.open("GET", url, true);

request.setRequestHeader("Authorization", "bearer "+access_token );
debugger;

//var url = window.location.pathname;
//var filename = url.substring(url.lastIndexOf('/')+1);

function getQueryStringValue (key) {  
	  return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]" + escape(key).replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));  
	}  


//var es = new EventSource('http://localhost:1337/channels/ticker');
/* source.onmessage = function(e) {
    alert(e.data);
}; */
var tenantid=getQueryStringValue("tenantid");


//request.send();
/* request.onreadystatechange  = function() {
		if (this.readyState == 4 && this.status == 200) {
	       // Action to be performed when the document is read;
			console.log(tenantid);
			source.addEventListener(
					tenantid,
			    function(event){
					console.log(event.data);
			        console.log(event.lastEventId);
			        alert("You've got a server event");
			        document.getElementById("result").innerHTML+=event.data + "<br>"; 
			       },
			    false);
	    }
	  
	} */ 
	 var tenantid=getQueryStringValue("tenantid");
	console.log(tenantid);
	source.addEventListener(
			tenantid,
	    function(event){
			console.log(event.data);
	        console.log(event.lastEventId);
	        alert("You've got a server event");
	        document.getElementById("result").innerHTML+=event.data + "<br>"; },
	    false);
	    
 

 
</script>
</body>
</html>